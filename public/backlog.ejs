<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Your Website</title>
    <link rel="stylesheet" href="styles/backlog.css">
    <script src="https://kit.fontawesome.com/b3e2cdb926.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

</head>
<header>
  <div class="menu-bar">
    <img src="styles/COMPACT.png" alt="Toggle Menu" onclick="toggleSidebar()" height="24" width="24">
    <a href="#home">Jira Look-Alike</a>
    <a href="#about">Your Work</a>
    <a href="#contact">Project</a>
    <a href="/dashboard">Dashboard</a>
    <a href="#contact">Plan   </a>
    <div class="icon-container">
        <button class="create-btn">Create</button>
        <input type="text" class="search-bar" placeholder="Search...">
        <div class="icon">&#x2605;</div>
        <div class="icon">&#128172;</div>
        <div class="icon">&#128073;</div>
        <div class="icon">&#128206;</div>
    </div>
</div>


</header>
<body>

    <!-- Menu Bar -->
    

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
      <div class="dropdown-btn" onclick="toggleDropdown('scrum-dropdown')">Scrum Board &#9660;</div>
      <div class="dropdown-content" id="scrum-dropdown">
          <a href="#"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;     Active Sprints</a>
          <a href="#">  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;    Backlog</a>
      </div>
      <div class="dropdown-btn" onclick="toggleDropdown('kanban-dropdown')">Kanban Board &#9660;</div>
      <div class="dropdown-content" id="kanban-dropdown">
          <a href="#">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Active Sprints</a>
          <a href="#">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Backlog</a>
      </div>
      <hr>
      <a href="#"id="BAR-L">Issues</a>
      <a href="#"id="BAR-L">Components</a>
      <a href="#"id="BAR-L">Releases</a>
      <a href="#"id="BAR-L">Project Pages</a>
      <a href="#"id="BAR-L">Add item</a>
      <a href="#"id="BAR-L">Project Settings</a>
      <br><br>
      <a href="/logout" style="color:rgb(251, 92, 92)">Log Out</a>
   </div>
   <div class="sidebar-right" id="sidebar-right">
    <% tasks.forEach(task => { %>
      <div class="task-sidebar">
        <h3>Task Name: <input type="text" id="taskName_<%= task.taskID %>" value="<%= task.task_name %>"></h3>
        <p>Description: <textarea id="description_<%= task.taskID %>"><%= task.description %></textarea></p>
        <p>Role: <input type="text" id="role_<%= task.taskID %>" value="<%= task.role %>"></p>
  
        <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
          <p>Start Date: <input type="date" id="startDate_<%= task.taskID %>" value="<%= task.start_date %>"></p>
          <p>End Date: <input type="date" id="endDate_<%= task.taskID %>" value="<%= task.end_date %>"></p>
        </div>
  
        <div class="task-buttons">
          <button class="delete" onclick="deleteTask('<%= task.taskID %>')"><i class="fa-solid fa-trash"></i></button>
          <button class="save" onclick="saveTask('<%= task.taskID %>')"><i class="fa-solid fa-floppy-disk"></i></button>
        </div>
      </div>
    <% }); %>
  </div>


    <!-- Page Content -->

    <div class="content" id="main">
        
          <div class="board">
            <h1 style="margin-top: 65px; position: absolute;">&nbsp;Backlog</h1>
             <input type="text" class="search-bar" placeholder="Search..." style="width: 120px; position: absolute;" onclick="searchTasks()">

             <form id="todo-forms">
                 <hr class="HANY">
              
                 <input type="text" placeholder="New Task..." id="todo-inputs"  style="background-color: #1c1c1c; position: absolute; margin-top: 840px;"/>
               
              <select> 
              
                    <option selected class="selected">Issue type</option>
                    <option>Bug</option>
                    <option>Story</option>
                    <option>Task</option>
                    <option>Improvement</option>
              </select>
              <button class="ADD" type="submit" style=" position: absolute; margin-top: 840px; margin-left:430px padding;">Add +</button>
              </form>
      
             
              <h1 style="z-index: 40; margin-left: 45px; font-size: 45px; margin-top: 60px; padding-left: 20px;"> Sprint</h1>
              <button class="COMPLETE" onclick="completeSprint()">Complete Sprint</button>
              <div class="filler1" >
              </div>
              <div class="lanes">
                    
                    <div class = "swim-lane" data-lane-number="5">
                       
                    </div>
              </div>
              

              <h1 style="z-index: 40;  font-size: 45px; margin-left: 45px; margin-top: 540px; padding-left: 20px;"> Backlog</h1>
              <button class="CREATE" onclick="createSprint()">Create Sprint</button>
              <div class="filler2" >
              </div>
              <div class="lanez" >
                
                <div class = "swim-lanez" data-lane-number="6">
                   
                </div>
              </div>
           
             <footer class ="footer">
              <div class = "container">
                <div class = "row">
                  <div class="footer-col">
                    <h4>company</h4>
                    <ul>
                      <li><a href="#">About Us</a></li>
                      <li><a href="#">our services</a></li>
                      <li><a href="#">privacy policy</a></li>
                      <li><a href="#">afffiliate program</a></li>
                      
                    </ul>
                  </div>
        
                  <div class="footer-col">
                    <h4>get help</h4>
                    <ul>
                      <li><a href="#">FAQ</a></li>
        
                    </ul>
                  </div>
        
                  <div class="footer-col">
                    <h4>follow us</h4>
                    <ul>
                      <div class = "social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                      </div>
                    </ul>
                  </div>
                </div>
              </div> 
          </footer>
            
          </div> 
          
        </div>

        
    <script>
      function toggleSidebarright() {
          console.log("hi");
          var sidebarleft = document.getElementById('sidebar');
          var sidebar = document.getElementsByClassName('sidebar-right')[0];
          var main = document.getElementById('main');
          if (sidebarleft.style.width == '250px') {
            sidebarleft.style.width = '';
            main.style.marginLeft = '0';
          }
          if (sidebar.style.width === '0' || sidebar.style.width === '') {
              sidebar.style.width = '375px';
              sidebar.style.right = '0';
             

             sidebar.style.borderWidth = '4px';
             sidebar.style.borderStyle = 'solid';
             sidebar.style.borderImage = 'linear-gradient(45deg, var(--clr-4), var(--clr-5)) 1 round';
             sidebar.style.position = 'fixed';
             sidebar.style.borderTop = 'none';
             sidebar.style.borderRight = 'none';
             sidebar.style.borderBottom = 'none';
          } else {
              sidebar.style.width = '';  
                 
          }
      }
  </script>
  <script>
    async function deleteTask(taskID) {
        try {
            // Use fetch to send a DELETE request to your server
            const response = await fetch(`/tasks/${taskID}`, {
                method: 'DELETE',
            });
  
            // Check if the request was successful
            if (response.ok) {
                // Reload the page or update the UI as needed
                location.reload();
            } else {
                // Handle errors or display a message to the user
                console.error('Failed to delete task');
            }
        } catch (error) {
            console.error('Error while deleting task:', error);
        }
    }
  
    async function saveTask(taskID) {
        try {
            // Get the input values from the corresponding input fields
            const taskName = document.getElementById(`taskName_${taskID}`).value;
            const description = document.getElementById(`description_${taskID}`).value;
            const role = document.getElementById(`role_${taskID}`).value;
            const startDate = document.getElementById(`startDate_${taskID}`).value;
            const endDate = document.getElementById(`endDate_${taskID}`).value;
  
            // Use fetch to send a PUT or PATCH request to your server with updated data
            const response = await fetch(`/tasks/${taskID}`, {
                method: 'PUT', // or 'PATCH' depending on your API design
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    task_name: taskName,
                    description: description,
                    role: role,
                    start_date: startDate,
                    end_date: endDate,
                }),
            });
  
            // Check if the request was successful
            if (response.ok) {
                // Reload the page or update the UI as needed
                location.reload();
            } else {
                // Handle errors or display a message to the user
                console.error('Failed to update task');
            }
        } catch (error) {
            console.error('Error while saving task:', error);
        }
    }
  </script>
  <script src="scripts/drag.js" defer></script>
  <script src="scripts/todobacklog.js" defer></script>
  <script src="scripts/toggledropdown.js"></script>
  <script src ="scripts/togglesidebar.js"></script>

   
   
</body>
</html>
